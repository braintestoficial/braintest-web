<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Braintest ‚Äî Plataforma de testes cognitivos, emocionais e de autoconhecimento. Descubra seu potencial.">
<meta name="keywords" content="tdah, burnout, teste de qi, autoconhecimento, intelig√™ncia, cognitivo, emocional">
<meta name="theme-color" content="#6366f1">
<link rel="preconnect" href="https://gqwgyresqsuciikmymkd.supabase.co">
<link rel="dns-prefetch" href="https://gqwgyresqsuciikmymkd.supabase.co">
  <title>Braintest ‚Äî Intelig√™ncia e Autoconhecimento</title>
  <link rel="stylesheet" href="/assets/ui.css" />
  <link rel="icon" href="/assets/logo.svg" type="image/svg+xml" />

  <!-- Importa biblioteca Supabase de forma ass√≠ncrona -->
  <script async src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>

<body>
  <header class="topbar">
    <div class="topbar-left">
      <img src="/assets/logo.svg" alt="Braintest" class="logo" />
    </div>

    <div class="topbar-center">
      <input type="search" id="searchBox" placeholder="Buscar testes ou jogos..." />
    </div>

    <div class="topbar-right">
      <span id="userEmail">Carregando...</span>
      <span id="walletBalance">0 üß†</span>
    </div>
  </header>

  <main class="main-container">
    <section class="intro">
      <h1>Bem-vindo(a) √† Braintest</h1>
      <p>Explore testes de autoconhecimento, cognitivos e emocionais. Tudo em um s√≥ lugar.</p>
    </section>

    <section class="tests-grid">
      <a href="/teste-tdah.html" class="test-card">
        <h3>TDAH</h3>
        <p>Descubra seu n√≠vel de aten√ß√£o e foco</p>
      </a>
      <a href="/teste-burnout.html" class="test-card">
        <h3>Burnout</h3>
        <p>Analise seu n√≠vel de estresse e exaust√£o</p>
      </a>
      <a href="/teste-qi.html" class="test-card">
        <h3>Q.I.</h3>
        <p>Teste sua capacidade l√≥gica e racioc√≠nio</p>
      </a>
    </section>
  </main>

  <footer class="footer">
    <a href="/faq.html">FAQ</a> ‚Ä¢
    <a href="/termos.html">Termos</a> ‚Ä¢
    <a href="/sobre.html">Sobre</a>
  </footer>

  <!-- Inicializa√ß√£o robusta do Supabase -->
  <script src="/assets/supabase-init.js"></script>

  <!-- Script principal (carregado ap√≥s Supabase estar pronto) -->
  <script>
    window.addEventListener("braintest-ready", async () => {
      const { data: { session } } = await sb.auth.getSession();
      if (session?.user) {
        document.getElementById("userEmail").textContent = session.user.email;
      } else {
        document.getElementById("userEmail").textContent = "Entrar com Google";
        document.getElementById("userEmail").onclick = async () => {
          const { data, error } = await sb.auth.signInWithOAuth({
            provider: "google",
            options: { redirectTo: window.location.origin }
          });
          if (error) alert("Erro ao logar: " + error.message);
        };
      }

      // Atualiza saldo
      try {
        const { data: { user } } = await sb.auth.getUser();
        const { data: wallet } = await sb
          .from("wallets")
          .select("balance")
          .eq("user_id", user?.id)
          .single();
        document.getElementById("walletBalance").textContent =
          (wallet?.balance ?? 0) + " üß†";
      } catch {
        document.getElementById("walletBalance").textContent = "0 üß†";
      }

      // Busca simples (redireciona)
      document.getElementById("searchBox").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          const q = e.target.value.trim().toLowerCase();
          if (q.includes("tdah")) location.href = "/teste-tdah.html";
          else if (q.includes("burnout")) location.href = "/teste-burnout.html";
          else if (q.includes("qi")) location.href = "/teste-qi.html";
          else alert("Nenhum teste encontrado com esse termo.");
        }
      });
    });
  </script>
</body>
</html>
