<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Braintest â€” Autoconhecimento, Cognitivo e Bem-estar</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Poppins:wght@700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/assets/ui.css">
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="/assets/supabase-init.js"></script>
<script src="/assets/app.js" defer></script>
</head>
<body>
<div class="shell">

  <header class="topbar">
    <a class="brand" href="/index.html"><img src="/assets/logo.svg" alt=""><span>Braintest</span></a>
    <div class="search" style="flex:1; margin-left:8px">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-3.5-3.5" stroke="#8a93a5" stroke-width="2" stroke-linecap="round"/><circle cx="11" cy="11" r="7" stroke="#8a93a5" stroke-width="2"/></svg>
      <input placeholder="Busque testes, temas, relatÃ³riosâ€¦">
    </div>
    <div class="user-chip" id="userChip">Carregandoâ€¦</div>
    <a class="btn alt" href="/carteira.html">Saldo: <span id="saldoTop">0.00</span> BC</a>
  </header>

  <div class="body">
    <aside class="sidebar">
      <nav class="nav">
        <h6>NavegaÃ§Ã£o</h6>
        <a href="/index.html" data-current class="active">ğŸ  InÃ­cio</a>
        <a href="/historico.html" data-current>ğŸ•˜ HistÃ³rico</a>
        <a href="/carteira.html" data-current>ğŸ’³ Carteira</a>
        <a href="/perfil.html" data-current>ğŸ‘¤ Perfil</a>

        <h6 style="margin-top:14px">Testes</h6>
        <a href="/teste-tdah.html" data-current>âš¡ TDAH <span class="badge">10 BC</span></a>
        <a href="/teste-burnout.html" data-current>ğŸ”¥ Burnout <span class="badge">10 BC</span></a>
        <a href="/teste-qi.html" data-current>ğŸ§  QI <span class="badge">10 BC</span></a>
      </nav>
    </aside>

    <main class="content">
      <div class="container">
        <div class="grid cols-3">
          <div class="card kpi">
            <div>
              <div class="title">Seu saldo</div>
              <div class="value"><span id="kpiSaldo">0.00</span> BC</div>
            </div>
            <a class="btn alt" href="/carteira.html">Adicionar BC</a>
          </div>

          <div class="card kpi">
            <div>
              <div class="title">Triagens realizadas</div>
              <div class="value" id="kpiTriagens">â€”</div>
            </div>
            <a class="btn alt" href="/historico.html">Ver histÃ³rico</a>
          </div>

          <div class="card kpi">
            <div>
              <div class="title">RelatÃ³rios premium</div>
              <div class="value" id="kpiPremiums">â€”</div>
            </div>
            <a class="btn alt" href="/historico.html">Abrir relatÃ³rios</a>
          </div>
        </div>

        <div class="card" style="margin-top:16px">
          <h3 style="margin:4px 0 12px;font-family:Poppins,Inter">Comece por aqui</h3>
          <div class="grid cols-3">
            <div class="card">
              <h4 style="margin:0 0 6px">âš¡ TDAH</h4>
              <p class="small" style="margin:0 0 12px">Triagem de sintomas com relatÃ³rio por domÃ­nios.</p>
              <div style="display:flex;gap:8px;flex-wrap:wrap">
                <a class="btn" href="/teste-tdah.html">Fazer triagem</a>
                <a class="btn alt" href="/tdah-premium.html">Ver premium</a>
              </div>
            </div>

            <div class="card">
              <h4 style="margin:0 0 6px">ğŸ”¥ Burnout</h4>
              <p class="small" style="margin:0 0 12px">ExaustÃ£o, cinismo e eficÃ¡cia, com plano prÃ¡tico.</p>
              <div style="display:flex;gap:8px;flex-wrap:wrap">
                <a class="btn" href="/teste-burnout.html">Fazer triagem</a>
                <a class="btn alt" href="/burnout-premium.html">Ver premium</a>
              </div>
            </div>

            <div class="card">
              <h4 style="margin:0 0 6px">ğŸ§  QI</h4>
              <p class="small" style="margin:0 0 12px">Estimativa por domÃ­nios e percentil.</p>
              <div style="display:flex;gap:8px;flex-wrap:wrap">
                <a class="btn" href="/teste-qi.html">Fazer triagem</a>
                <a class="btn alt" href="/qi-premium.html">Ver premium</a>
              </div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:16px">
          <h3 style="margin:4px 0 12px;font-family:Poppins,Inter">AtualizaÃ§Ãµes</h3>
          <div class="table-wrap">
            <div class="table-row" style="display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--line)">
              <div><b>Novo layout</b> â€” navegaÃ§Ã£o estÃ¡vel no desktop e mobile.</div>
              <div class="badge">Hoje</div>
            </div>
            <div class="table-row" style="display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--line)">
              <div><b>HistÃ³rico</b> â€” sessÃµes salvas com filtro e detalhamento.</div>
              <div class="badge">Novo</div>
            </div>
            <div class="table-row" style="display:flex;justify-content:space-between;padding:10px 0">
              <div><b>Braincoins</b> â€” compras internas unificadas.</div>
              <div class="badge">EstÃ¡vel</div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <nav class="mobilebar">
    <a href="/index.html" data-current class="active">ğŸ </a>
    <a href="/teste-tdah.html" data-current>âš¡</a>
    <a href="/teste-burnout.html" data-current>ğŸ”¥</a>
    <a href="/teste-qi.html" data-current>ğŸ§ </a>
    <a href="/perfil.html" data-current>ğŸ‘¤</a>
  </nav>
</div>

<script>
(async ()=>{
  await waitForSupabaseSession();
  const { data:{ user } } = await sb.auth.getUser();
  if(!user){ document.getElementById('userChip').textContent='Entrar'; return; }

  const { data:w } = await sb.from('wallets').select('balance_cents').eq('user_id', user.id).single();
  const saldo = ((w?.balance_cents||0)/100);
  setTopUser(user.email || 'UsuÃ¡rio', saldo);
  document.getElementById('kpiSaldo').textContent = saldo.toFixed(2);

  const { count:sCount } = await sb.from('test_sessions').select('id', { count:'exact', head:true }).eq('user_id', user.id);
  document.getElementById('kpiTriagens').textContent = sCount ?? 0;

  const { data:pRows } = await sb.from('purchases').select('product').eq('user_id', user.id);
  document.getElementById('kpiPremiums').textContent = (pRows?.length||0);
})();
</script>
</body>
</html>
