<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Relatório Premium — Burnout | Braintest</title>
<link rel="stylesheet" href="/assets/ui.css">
<script async src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
<header class="topbar">
  <a class="brand" href="/index.html"><img src="/assets/logo.svg" height="28"> Braintest</a>
  <div class="userbox"><b id="userChip">Carregando...</b></div>
</header>

<main class="content">
  <div class="card">
    <h2>Relatório Premium — Burnout</h2>
    <p>Resultado personalizado com base em suas respostas:</p>
    <div id="resultado"><p>Carregando dados…</p></div>
  </div>
</main>

<script src="/assets/supabase-init.js"></script>
<script>
window.addEventListener("braintest-ready", async()=>{
  const { data:{ user } } = await sb.auth.getUser();
  if(!user){ location.href="/"; return; }
  document.getElementById("userChip").textContent = user.email.split("@")[0];

  const { data } = await sb.from("test_sessions")
    .select("*")
    .eq("user_id", user.id)
    .eq("test_key", "burnout")
    .order("created_at",{ascending:false})
    .limit(1)
    .single();

  const score = data?.score_likert ?? 0;
  let texto="";
  if(score<=10) texto="Níveis saudáveis de estresse. Indica boa capacidade de recuperação e equilíbrio entre vida pessoal e profissional.";
  else if(score<=20) texto="Sinais moderados de exaustão. É importante observar pausas regulares e reforçar hábitos de autocuidado.";
  else texto="Alto risco de Burnout. Seus resultados sugerem sobrecarga emocional e física. Considere procurar apoio psicológico.";
  document.getElementById("resultado").innerHTML=`
    <h3>Pontuação: ${score}</h3>
    <p>${texto}</p>
    <hr>
    <p><i>*Este relatório é um indicativo de estresse ocupacional e não substitui diagnóstico médico.</i></p>`;
});
</script>
</body>
</html>
