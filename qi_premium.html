<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Relatório Premium — Q.I. | Braintest</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@600&display=swap" rel="stylesheet">
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<style>
:root{--salmao:#ff8a73;--salmao-2:#ff7458;--azul:#1d3557;--bg:#f6f7fb;--card:#fff;--borda:#e9ecf2;--texto:#2b2b2b}
*{box-sizing:border-box;margin:0;padding:0} body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--texto)}
.wrap{max-width:1100px;margin:0 auto;padding:1rem}
header.top{display:flex;align-items:center;justify-content:space-between;background:#fff;border:1px solid var(--borda);border-radius:14px;padding:1rem;margin-top:1rem}
.brand{display:flex;align-items:center;gap:.6rem} .brand img{width:28px} .brand h1{font-family:'Poppins',sans-serif;font-size:1.2rem;color:var(--azul)}
nav a{margin-left:1rem;color:var(--azul);text-decoration:none}
.btn{background:var(--salmao);color:#fff;border:none;border-radius:10px;padding:.55rem .9rem;font-weight:700;cursor:pointer}
.btn.secondary{background:#fff;color:var(--azul);border:1px solid var(--borda)}
.btn:hover{background:var(--salmao-2)}
.card{background:var(--card);border:1px solid var(--borda);border-radius:14px;padding:1rem;margin-top:1rem}
h2{font-family:'Poppins',sans-serif;color:var(--azul);margin:.3rem 0  .5rem}
h3{color:#0e1d33;margin:.8rem 0 .4rem}
.muted{color:#6b7380}
.badge{display:inline-block;border:1px solid var(--borda);border-radius:999px;padding:.2rem .6rem;background:#f7f9ff;font-size:.85rem;margin-left:.5rem}
.grid{display:grid;gap:1rem;grid-template-columns:1fr 1fr} @media(max-width:900px){.grid{grid-template-columns:1fr}}
.section{padding:.6rem 0}
.note{background:#fff7f5;border:1px dashed #ffd5cb;padding:.8rem;border-radius:10px}
.kpi{display:flex;gap:1rem;flex-wrap:wrap;margin:.6rem 0}
.kpi .box{flex:1 1 220px;border:1px solid var(--borda);border-radius:12px;padding:.8rem;background:#fff}
.kpi .val{font-size:1.4rem;font-weight:800;color:var(--azul)}
.footer{text-align:center;color:#6b7380;font-size:.9rem;padding:1.5rem}
</style>
</head>
<body>
<div class="wrap">
  <header class="top">
    <div class="brand"><img src="assets/logo.svg" alt=""><h1>Braintest</h1></div>
    <nav>
  <a href="index.html">Início</a>
  <a href="carteira.html" class="btn secondary">Carteira: <span id="saldoBC">0.00</span> BC</a>
  <a href="historico.html">Histórico</a>
  <span id="userInfo" class="badge">Carregando…</span>
</nav>

  </header>

  <section class="card" id="guard">
    <h2>Relatório Premium — Q.I.</h2>
    <p class="muted">Acesso verificado: <span id="statusAcc">verificando…</span></p>
  </section>

  <section class="card" id="conteudo" style="display:none">
    <div class="section">
      <h3>Resumo do desempenho</h3>
      <p>Estimativa de Q.I. com análise por domínios (lógico, numérico e padrões visuais). Interpretação contextual e recomendações de aprimoramento.</p>
      <div class="kpi">
        <div class="box"><div class="muted">Q.I. estimado</div><div class="val" id="kQI">—</div></div>
        <div class="box"><div class="muted">Força principal</div><div class="val" id="kDom">—</div></div>
        <div class="box"><div class="muted">Área a desenvolver</div><div class="val" id="kDev">—</div></div>
      </div>
    </div>

    <div class="grid">
      <div class="section">
        <h3>Interpretação</h3>
        <p id="interp">O resultado indica desempenho consistente, com destaque em raciocínio <span id="destaque">—</span>. Recomenda-se treinar problemas de múltiplas etapas para consolidar estratégias.</p>
      </div>
      <div class="section">
        <h3>Práticas de treino</h3>
        <ul>
          <li>Quebra de problemas em <strong>sub-metas</strong> (passos numerados).</li>
          <li>Exercícios diários de <strong>padrões e séries</strong> (15–20 min).</li>
          <li>Diário de erros: registre <strong>onde errou</strong> e a correção.</li>
          <li>Rotina de sono e intervalos curtos para manter foco.</li>
        </ul>
      </div>
    </div>

    <div class="section">
      <h3>Próximos passos</h3>
      <p class="note">Este relatório tem caráter informativo e não equivale a avaliação psicométrica padronizada. Para fins oficiais, busque um profissional habilitado.</p>
    </div>

    <div class="section">
      <h3>Outros relatórios</h3>
      <div class="kpi">
        <div class="box"><div class="muted">TDAH</div><div><a class="btn secondary" href="teste-tdah.html">Explorar</a></div></div>
        <div class="box"><div class="muted">Burnout</div><div><a class="btn secondary" href="teste-burnout.html">Explorar</a></div></div>
      </div>
    </div>
  </section>

  <div class="footer">© 2025 Braintest — Uso pessoal e informativo.</div>
</div>

<script>
const SUPABASE_URL="https://gqwgyresqsuciikmymkd.supabase.co";
const SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdxd2d5cmVzcXN1Y2lpa215bWtkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzNDQ5NTIsImV4cCI6MjA3NTkyMDk1Mn0.e9EfNqXvrujJm9jmG5SCJ2EShoq0PAbxTuv1kvs0FnQ";
const sb=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);

async function carregarSaldo(){
  const { data:{user} } = await sb.auth.getUser(); if(!user) return;
  const { data } = await sb.from('wallets').select('balance_cents').eq('user_id',user.id).single();
  const cents=data?.balance_cents||0; document.getElementById('saldoBC').textContent=(cents/100).toFixed(2);
}

async function gate(){
  const { data:{user} } = await sb.auth.getUser();
  const statusEl=document.getElementById('statusAcc'); const userInfo=document.getElementById('userInfo');
  if(!user){ alert('Faça a triagem e adquira o relatório para acessar.'); location.href='teste-qi.html'; return; }
  userInfo.textContent=user.email;

  const { data, error } = await sb.from('purchases').select('id').eq('user_id',user.id).eq('product','qi').maybeSingle();
  if(error || !data){ statusEl.textContent='negado'; alert('Acesso não autorizado. Adquira o relatório premium.'); location.href='teste-qi.html'; return; }

  statusEl.textContent='liberado';
  document.getElementById('conteudo').style.display='block';
  carregarSaldo();

  // valores sintéticos amigáveis
  const qi = 95 + Math.floor(Math.random()*31); // 95–125
  const doms=['Lógico','Numérico','Padrões visuais'];
  const forte=doms[Math.floor(Math.random()*doms.length)];
  let dev = doms.filter(d=>d!==forte)[Math.floor(Math.random()*2)];
  document.getElementById('kQI').textContent = qi;
  document.getElementById('kDom').textContent = forte;
  document.getElementById('kDev').textContent = dev;
  document.getElementById('destaque').textContent = forte.toLowerCase();
}

document.addEventListener('DOMContentLoaded', gate);
</script>
</body>
</html>
